{{template "header" .}}
<div class="main" class="fonty">
	{{ if .SignedIn}}
	<a href='/{{.Domain}}/{{.RandomUUID}}' class='fr'>New page</a>
	{{end}}
	{{with .Message}}
	<p style="color:red;"><em>{{.}}</em></p>
	{{end}}

	<h1>Welcome</h1>
	<p>This is <em>cowyo</em>, a completely simple text-based web content management system. Write anything you want, or just paste things to remember.
	</p>

	<p>This is the <strong>{{.Domain}}</strong> domain, each page will begin with <code>/{{.Domain}}/</code>.
	
	{{if .DomainExists}}
	{{if eq .Domain "public"}}Anyone can view and edit these pages. To keep content to yourself, create a domain (below).{{else}}{{ if .SignedIn}}Anyone
		can view these pages. Only you can edit pages, since you are are logged in (log out
		<a href="/logout?d={{.Domain}}">here</a>). {{else}}You are not logged in and cannot edit pages.{{end}}{{end}}</p>
	<p>
		<h2>Recent pages</h2>
		<ul>
			{{range .Files}}
			<li>
				<small>{{.Modified.Format "Mon Jan 2 2006"}}</small>
				<a href="/{{$.Domain}}/{{.ID}}">{{if eq (len .Slug) 0}}{{.ID}}{{else}}{{.Slug}}{{end}}</a>
			</li>
			{{end}}
		</ul>
	</p>
	<p>
	<h2>Search</h2>
			<form action="/{{.Domain}}" method="get">
				<input type="text" name="q" value="" size="35">
				<input type="submit" value="Search">
			</form>
		</p>
	{{else}}
	This domain does not yet exist. You can create it below.</p>{{end}}


	<p>
		
		
			{{if eq .Domain "public"}}
				<h2>Create domain</h2>
				<p>Creating a domain allows you to make new posts that only you can edit (but anyone can view).</p>
			{{ else }}
				{{if .DomainExists}}
					{{ if .SignedIn}}
					<h2>Create another domain</h2>
					{{ else }}
					<h2>Log in</h2>
					<p>You can view pages without logging in, but you cannot edit unless you log in first.</p>
					{{ end }}
				{{ else }}
					<h2>Create domain</h2>
					<p>Creating a domain allows you to make new posts that only you can edit (but anyone can view).</p>		
				{{end}}
			{{end}}
		<form action="/login" method="post">
			<input type="text" name="domain" value="" placeholder="Enter domain name..." size="20">
			<input name="key" value="" type="password" placeholder="Enter a key..." size="20">
			<input type="submit" value="Submit">
		</form>
	</p>
</div>
{{template "footer" .}}